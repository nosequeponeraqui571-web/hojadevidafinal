<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <style>
        @page {
            size: letter;
            margin: 2cm;
            @frame footer_frame {           /* Static Frame */
                -pdf-frame-content: footerContent;
                bottom: 1cm;
                margin-left: 1cm;
                margin-right: 1cm;
                height: 1cm;
            }
        }

        body {
            font-family: Helvetica, Arial, sans-serif;
            color: #000;
            line-height: 1.4;
            font-size: 10pt;
        }

        /* --- ENCABEZADO --- */
        .header {
            text-align: center;
            margin-bottom: 25px;
            border-bottom: 2px solid #333;
            padding-bottom: 15px;
        }

        .name {
            font-size: 24pt;
            font-weight: bold;
            text-transform: uppercase;
            color: #1a202c; /* Gris muy oscuro */
            margin-bottom: 5px;
        }

        .contact-info {
            font-size: 9pt;
            color: #4a5568; /* Gris medio */
        }

        /* --- SECCIONES --- */
        .section-title {
            font-size: 13pt;
            font-weight: bold;
            text-transform: uppercase;
            color: #2d3748;
            margin-top: 20px;
            margin-bottom: 10px;
            border-bottom: 1px solid #cbd5e0;
            padding-bottom: 3px;
        }

        /* --- ITEMS (Experiencia / Cursos) --- */
        .item-block {
            margin-bottom: 12px;
            page-break-inside: avoid; /* Evita que un item se corte a mitad de página */
        }

        .item-header {
            font-weight: bold;
            font-size: 11pt;
            color: #000;
        }

        .item-sub {
            font-size: 9pt;
            color: #4a5568;
            margin-top: 1px;
            margin-bottom: 3px;
            font-style: italic;
        }

        .item-desc {
            text-align: justify;
            margin-top: 2px;
            font-size: 10pt;
        }

        /* Listas limpias */
        ul { margin: 5px 0; padding-left: 15px; }
        li { margin-bottom: 2px; }

        /* --- UTILIDADES --- */
        .page-break { page-break-after: always; }
        
        .anexo-page {
            display: block;
            text-align: center;
            margin-top: 40%;
        }
        .anexo-box {
            border: 2px solid #000;
            padding: 30px;
            display: inline-block;
        }
    </style>
</head>
<body>

    <!-- ENCABEZADO -->
    <div class="header">
        <div class="name">{{ perfil.nombres }} {{ perfil.apellidos }}</div>
        <div class="contact-info">
            C.I: {{ perfil.numerocedula }} | {{ perfil.email_contacto }}<br>
            {{ perfil.telefonofijo }} | {{ perfil.direcciondomiciliaria }}
        </div>
    </div>

    <!-- PERFIL -->
    <div class="section-title">Perfil Profesional</div>
    <div style="text-align: justify; margin-bottom: 10px;">
        {{ perfil.descripcionperfil }}
    </div>

    <!-- EXPERIENCIA LABORAL -->
    {% if incl_experiencia and items %}
    <div class="section-title">Experiencia Profesional</div>
    {% for exp in items %}
    <div class="item-block">
        <div class="item-header">{{ exp.cargodesempenado }}</div>
        <div class="item-sub">
            {{ exp.nombrempresa }} | {{ exp.lugarempresa }} 
            <!-- FECHAS A LA DERECHA (O INTEGRADOS) -->
            &nbsp;&nbsp;&bull;&nbsp;&nbsp; 
            {{ exp.fechainiciogestion|date:"M Y" }} - 
            {% if exp.fechafingestion %}
                {{ exp.fechafingestion|date:"M Y" }}
            {% else %}
                Actualidad
            {% endif %}
        </div>
        <div class="item-desc">
            {{ exp.descripcionfunciones|linebreaksbr }}
        </div>
    </div>
    {% endfor %}
    {% endif %}

    <!-- EDUCACIÓN Y FORMACIÓN (CURSOS) -->
    {% if incl_cursos and cursos %}
    <div class="section-title">Educación y Formación</div>
    {% for curso in cursos %}
    <div class="item-block">
        <div class="item-header">{{ curso.nombrecurso }}</div>
        <div class="item-sub">
            {{ curso.entidadpatrocinadora }}
            &nbsp;&nbsp;&bull;&nbsp;&nbsp;
            {{ curso.fechainicio|date:"M Y" }} - {{ curso.fechafin|date:"M Y" }}
            &nbsp;&nbsp;&bull;&nbsp;&nbsp;
            {{ curso.totalhoras }} Horas
        </div>
        {% if curso.descripcioncurso %}
        <div class="item-desc">{{ curso.descripcioncurso }}</div>
        {% endif %}
    </div>
    {% endfor %}
    {% endif %}

    <!-- LOGROS -->
    {% if incl_logros and reconocimientos %}
    <div class="section-title">Logros y Reconocimientos</div>
    <ul class="bullet-list">
        {% for rec in reconocimientos %}
            <li>
                <strong>{{ rec.tiporeconocimiento }}</strong> otorgado por {{ rec.entidadpatrocinadora }} ({{ rec.fechareconocimiento|date:"Y" }}).
                <br><i>{{ rec.descripcionreconocimiento }}</i>
            </li>
        {% endfor %}
    </ul>
    {% endif %}

    <!-- PRODUCTOS ACADÉMICOS Y LABORALES SEPARADOS -->
    {% if incl_proyectos %}
        
        <!-- SECCIÓN 1: PRODUCTOS ACADÉMICOS -->
        {% if productos %}
        <div class="section-title">Productos Académicos</div>
        <ul>
            {% for prod in productos %}
            <li>
                <strong>{{ prod.nombrerecurso }}</strong>: {{ prod.descripcion }}
            </li>
            {% endfor %}
        </ul>
        {% endif %}

        <!-- SECCIÓN 2: PRODUCTOS LABORALES -->
        {% if productos_laborales %}
        <div class="section-title">Productos Laborales</div>
        <ul>
            {% for prod in productos_laborales %}
            <li>
                <strong>{{ prod.nombreproducto }}</strong> ({{ prod.fechaproducto|date:"Y" }}): {{ prod.descripcion }}
            </li>
            {% endfor %}
        </ul>
        {% endif %}

    {% endif %}

    <!-- GARAJE (Opcional) -->
    {% if incl_garage and garage %}
    <div class="section-title">Venta de Garage</div>
    <ul>
        {% for g in garage %}
            <li>{{ g.nombreproducto }} - ${{ g.valordelbien }} (Estado: {{ g.estadoproducto }})</li>
        {% endfor %}
    </ul>
    {% endif %}

    <!-- PORTADA DE ANEXOS -->
    {% if incl_experiencia or incl_cursos or incl_logros or incl_garage %}
    <div class="page-break"></div>
    <div class="anexo-page">
        <div class="anexo-box">
            <h1 style="font-size: 24pt; margin: 0;">ANEXOS</h1>
            <p style="margin-top: 10px;">Documentación de Respaldo</p>
        </div>
    </div>
    {% endif %}

    <!-- FOOTER ESTÁTICO PARA NUMERACIÓN -->
    <div id="footerContent" style="text-align: right; color: #888; font-size: 8pt;">
        Página <pdf:pagenumber> de <pdf:pagecount>
    </div>

</body>
</html>